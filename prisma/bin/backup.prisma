


// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  // output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}



model User {
  id        String    @id @default(uuid())
  username  String?
  email     String    @unique
  password  String
  role      Role      @default(USER)
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt

  // RELATIONSHIPS
  products  Product[] // mean user can have many product one to many
  carts Cart[]
}

enum Role {
  ADMIN
  EMPLOYER
  USER
}

model Product {
  id          String   @id  @default(uuid())
  title       String
  description String?  @db.Text
  createdAt   DateTime @default(now())
  updateAt    DateTime @updatedAt
  
  // FOREIGN KEY TO USER
  user        User     @relation(fields: [userId], references: [id])
  userId      String

  category  Category? @relation(fields: [categoryId], references: [id])
  categoryId  String?

  brand       Brand?    @relation(fields: [brandId], references: [id])
  brandId     String?

  // RELATIONSHIPS
  variants  Variant[]
  images    Image[]
}

model Variant {
  id    String    @id @default(uuid())
  sku   String    @unique
  price Decimal   @db.Decimal(10,2)
  stock Int       @default(0)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  // FOREINGN KEY TO PRODUCT
  product Product @relation(fields: [productId], references: [id])
  productId String

  // relateion key to variatnt_option
  variantOptions VariantOption[]
  cart  CartItem[]
  // One-to-many relationship with VariantOption
  // You might also have a direct 'image' field here if each variant has its own primary image
  // imageUrl  String?
}

model VariantOption {
  id  String @id @default(uuid())
  attributeName String
  attributeValue  String

  // FOREIGN KEY TO VARIANT
  variant Variant @relation(fields: [variantId], references: [id])
  variantId String

  @@unique([variantId, attributeName]) // Ensure only one value for an attribute per variant
}


model Image {
  id          String @id @default(uuid())
  url         String
  altText     String
  isPrimary   Boolean @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // FOREIGN KEY TO PRODUCT
  product     Product @relation(fields: [productId], references: [id])
  productId String
}

model Category   {
  id  String @id  @default(uuid())
  categoryName  String?  @unique
  products  Product[]
}

model Brand {
  id  String @id @default(uuid())
  brandName String  @unique
  products Product[]
}


model Cart {
  id        String    @id @default(uuid())
  userId    String
  user      User      @relation(fields: [userId], references: [id])
  items     CartItem[]
}

model CartItem {
  id        String  @id @default(uuid())
  cartId    String
  cart      Cart    @relation(fields: [cartId], references: [id])
  variantId String
  variant   Variant @relation(fields: [variantId], references: [id])
  quantity  Int     @default(1)

  @@unique([cartId, variantId]) // Prevent duplicate items
}






// model User {
//   id        String    @id @default(uuid())
//   username String
//   email  String
//   password String
//   role Role @default(USER)
//   createdAt DateTime  @default(now())
//   updatedAt DateTime  @updatedAt
//   carts     Cart[]
//   orders    Order[]
//   products  Product[]
// }

// enum Role {
//   ADMIN
//   USER
// }

// model Product {
//   id          String    @id @default(uuid())
//   title       String
//   description String
//   createdAt   DateTime  @default(now())
//   updateAt    DateTime  @updatedAt
//   userId      String
//   categoryId  String? // link
//   brandId     String? // link
//   // categoryId  String?
//   // brandId     String?
//   variants    Variant[]
//   images      Image[]
//   cartItems   CartItem[]
//   orderItems  OrderItem[]
//   User        User      @relation(fields: [userId], references: [id])
  
//   Category    Category? @relation(fields: [categoryId], references: [id])
//   Brand       Brand?    @relation(fields: [brandId], references: [id])
// }


// model Category   {
//   id  String @id  @default(uuid())
//   categoryName  String?  @unique
//   Products  Product[]
// }

// model Brand {
//   id  String @id @default(uuid())
//   brandName String  @unique
//   Products Product[]

// }
// model Variant {
//   id             String         @id @default(uuid())
//   sku            String
//   price          String
//   stock          Int
//   createdAt      DateTime       @default(now())
//   updatedAt      DateTime       @updatedAt
//   productId      String
//   variantOptions VariantOption[]
//   cartItems      CartItem[]
//   orderItems     OrderItem[]
//   Product        Product        @relation(fields: [productId], references: [id])
// }

// model VariantOption {
//   id             String   @id @default(uuid())
//   attributeName  String
//   attributeValue String
//   variantId      String
//   createdAt      DateTime @default(now())
//   updatedAt      DateTime @updatedAt
//   Variant        Variant  @relation(fields: [variantId], references: [id])
// }

// model Image {
//   id        String   @id @default(uuid())
//   url       String
//   altText   String
//   isPrimary Boolean
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
//   productId String
//   Product   Product  @relation(fields: [productId], references: [id])
// }

// model Cart {
//   id        String     @id @default(uuid())
//   userId    String
//   createdAt DateTime   @default(now())
//   updatedAt DateTime   @updatedAt
//   items     CartItem[]
//   User      User       @relation(fields: [userId], references: [id])
// }

// model CartItem {
//   id        String   @id @default(uuid())
//   cartId    String
//   productId String
//   variantId String
//   quantity  Int
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
//   Cart      Cart     @relation(fields: [cartId], references: [id])
//   Product   Product  @relation(fields: [productId], references: [id])
//   Variant   Variant  @relation(fields: [variantId], references: [id])
// }

// model Order {
//   id         String      @id @default(uuid())
//   userId     String
//   totalPrice Float
//   status     String      @default("pending")
//   createdAt  DateTime    @default(now())
//   updatedAt  DateTime    @updatedAt
//   items      OrderItem[]
//   User       User        @relation(fields: [userId], references: [id])
// }

// model OrderItem {
//   id        String   @id @default(uuid())
//   orderId   String
//   productId String
//   variantId String
//   quantity  Int
//   price     String
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
//   Order     Order    @relation(fields: [orderId], references: [id])
//   Product   Product  @relation(fields: [productId], references: [id])
//   Variant   Variant  @relation(fields: [variantId], references: [id])
// }
